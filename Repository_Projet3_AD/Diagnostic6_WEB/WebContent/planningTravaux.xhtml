<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<ui:composition template="/WEB-INF/Template1Diagnostic6.xhtml">
	<ui:define name="title">Diagnostic 6 - Planing travaux</ui:define>
	
	<ui:define name="head">
		<link href="css/planningTravaux.css" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="JavaScript/planningTravaux.js"></script>
	</ui:define>
	
	<ui:define name="content">

		<div id="content">
		<h:form>
		<table id="monTableau">
			<tr id="idBidon" class="table-header1">
				<th colspan="12">Nom de l'ERP + Numéro de chantier</th>
			</tr>
			
			<tr id="idBidon" class="table-header2">
				<th class="NomIntervention"></th>
				<th class="Etat"></th>
				<th colspan="2">flèche?</th>
				<th colspan="2"></th>
				<th colspan="2">2015</th>
				<th colspan="2"></th>
				<th colspan="2"></th>
			</tr>
			
			<tr id="idBidon" class="table-header3">
				<th class="NomIntervention">Interventions</th>
				<th class="Etat">Etat</th>
				<th class="Temps" id="date1" colspan="2">#{mbTestTravaux.formater.format(mbTestTravaux.date1)}</th>
				<th class="Temps" colspan="2"></th>
				<th class="Temps" id="date2" colspan="2">#{mbTestTravaux.formater.format(mbTestTravaux.date2)}</th>
				<th class="Temps" colspan="2"></th>
				<th class="Temps" id="date3" colspan="2">#{mbTestTravaux.formater.format(mbTestTravaux.date3)}</th>
			</tr>
			
			<ui:repeat var="item" value="#{mbTestTravaux.listeTypes}">
				<tr id="T#{item.idTypeIntervention}" class="ligneBleueType">
					<td onClick="afficherCacher('T#{item.idTypeIntervention} -')">#{item.typeIntervention}</td>
					<td></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
				</tr>
				
				<ui:repeat var="intervention" value="#{item.listeInterventionTypeIntervention}">
					
					
					<tr id="T#{item.idTypeIntervention} - A#{intervention.anomalie.idAnomalie}" class="ligneBleueIntervention">
						<td>
							<span class="spanIntervention">Intervention #{intervention.idIntervention}</span>
						</td>
						
						<td>
							<img id="iconeEtat - #{intervention.idIntervention}" src=""/>
						</td>
						
						<td class="tiretsBleus" style="padding-right:4px">
							<div class="rectangle" id="#{intervention.idIntervention}">
								<span class="dateDebut">#{mbTestTravaux.shortFormater.format(
											 intervention.dateDebutIntervention)
											}
								</span>
								<span class="dateFin">#{mbTestTravaux.shortFormater.format(
											 intervention.dateFinIntervention)
											}
								</span>
							</div>
						</td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					
					<td class="tiretsBleus"></td>
					<td class="traitsGris"></td>
					</tr>
					
					<tr id="T#{item.idTypeIntervention} - A#{intervention.anomalie.idAnomalie} - Description" class="ligneOrange">
						<td colspan="12">
							<div>
								<h4>Informations sur l'intervention</h4>
								
								<h:outputLabel value="Etat d'avancement :" />
								
								<h:selectOneMenu 	id="S#{intervention.idIntervention}"
													value="#{intervention.etatAvancementTravaux.idEtatAvancement}">
									<f:selectItems	value="#{mbTestTravaux.listeEtatDisponiblesParIntervention(intervention)}"
								   					var="var"
								  					itemLabel="#{var.intituleEtatAvancement}"
								  					itemValue="#{var.idEtatAvancement}"/>								
								</h:selectOneMenu>
		
								
								
								<h:outputLabel value="Date de début :" />
									<input type="text" 
											id="datepickerDebut - #{intervention.idIntervention}" 
											class="datepick"
											value="#{mbTestTravaux.formater.format(
											 intervention.dateDebutIntervention)
											}"
											disabled="disabled"/>
								
								<h:outputLabel value="Date de fin :" /> 
									<input type="text"
										   id="datepickerFin - #{intervention.idIntervention}"
										   value="#{mbTestTravaux.formater.format(
											 intervention.dateFinIntervention)
											}"
										   class="datepick"
										   disabled="disabled"/>	
								
								<input class="boutonModifier"
									   type="button"
									   id="boutonModifier - #{intervention.idIntervention}"
									   value="Modifier"
									   onClick="disabledEnabled('#{intervention.idIntervention}')"/>
								
								<input type="button" 
									   value="Valider les modifications" 
									   id="boutonValider - #{intervention.idIntervention}"
									   style="display:none"/>				
							</div>
							
							<div>
								<h:outputLabel value="Type d'intervention :" />
								
								<h:selectOneMenu 	value="#{intervention.typeIntervention.idTypeIntervention}">
									<f:selectItems	value="#{mbTestTravaux.listeTypes}"
								   					var="var"
								  					itemLabel="#{var.typeIntervention}"
								  					itemValue="#{var.idTypeIntervention}"/>								
								</h:selectOneMenu>
								
								<h:outputLabel value="Artisan :" />
								
								<h:selectOneMenu 	value="#{intervention.artisan.idArtisan}">
									<f:selectItems	value="#{mbTestTravaux.avoirListeArtisans(item)}"
								   					var="var"
								  					itemLabel="#{var.nomArtisan}"
								  					itemValue="#{var.idArtisan}"/>								
								</h:selectOneMenu>	
								
								<h:outputLabel value="Coût :" />
									<input type="number"
										   id="cout - #{intervention.idIntervention}"
										   step="1.00"
										   disabled="disabled"
										   value="#{intervention.coutIntervention}"/>	
							</div>
							
							<div>
								<h4>Informations sur l'anomalie</h4>
								<h:outputLabel value="Localisation de l'anomalie :" />
								<p class="localisationAnomalie">
								<h:outputText value="#{mbTestTravaux.localisationAnomalie(intervention.anomalie)}"
												escape="false"/>	
								</p>
							</div>
													
							<div class="preconisationAnomalie">								
								<h:outputLabel value="Description de l'anomalie :" />
								<p>#{intervention.anomalie.preconisationAnomalie}</p>				
							</div>							
							
							</td>
						
					</tr>
				</ui:repeat>

							
			</ui:repeat>
		
		</table>
			</h:form>
		</div>
		
	<script>
	jQuery.noConflict();
	
	jQuery('.datepick').each(function(){
		jQuery(this).datepicker();
	});
	
	jQuery('.rectangle').each(function(){
		dessinerRectangle(this);
		
	});

	jQuery('select').each(function(){
		var id = jQuery(this).closest('tr').prev().find('.rectangle').attr('id');
		afficherMasquerEtatAvancement(id, this.value);
	});
	
	jQuery('.ligneBleueIntervention').click(function(){
		jQuery(this).closest('tr').next().fadeToggle('medium');
	});
	
  </script>

	</ui:define>

</ui:composition>

</html>